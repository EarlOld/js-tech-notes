<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Array vs Float32Array Benchmark</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
      }
      button {
        margin: 0.5rem;
        padding: 0.6rem 1.2rem;
        font-size: 1rem;
      }
      pre {
        background: #111;
        color: #0f0;
        padding: 1rem;
        margin-top: 1rem;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <h1>üî¨ Benchmark: Array vs Float32Array</h1>
    <button onclick="testArray()">‚ñ∂Ô∏è Benchmark Array</button>
    <button onclick="testTypedArray()">‚ñ∂Ô∏è Benchmark Float32Array</button>

    <pre id="output">Waiting for input...</pre>

    <script>
      const output = document.getElementById("output");
      const size = 1024;

      function log(msg) {
        output.textContent += `\n${msg}`;
      }

      function clearLog() {
        output.textContent = "";
      }

      // Matrix multiplication for 2D arrays
      function multiplyArray(A, B, size) {
        const result = Array.from({ length: size }, () => Array(size).fill(0));
        for (let i = 0; i < size; i++) {
          for (let j = 0; j < size; j++) {
            let sum = 0;
            for (let k = 0; k < size; k++) {
              sum += A[i][k] * B[k][j];
            }
            result[i][j] = sum;
          }
        }
        return result;
      }

      // Matrix multiplication for flat Float32Arrays
      function multiplyTypedArray(A, B, C, size) {
        for (let i = 0; i < size; i++) {
          for (let j = 0; j < size; j++) {
            let sum = 0;
            for (let k = 0; k < size; k++) {
              sum += A[i * size + k] * B[k * size + j];
            }
            C[i * size + j] = sum;
          }
        }
      }

      function testArray() {
        const A = Array.from({ length: size }, () =>
          Array.from({ length: size }, () => Math.random() * 1000)
        );
        const B = Array.from({ length: size }, () =>
          Array.from({ length: size }, () => Math.random() * 1000)
        );
        log("Starting Array √ó Array multiplication...");
        const t0 = performance.now();
        const C = multiplyArray(A, B, size);
        const t1 = performance.now();
        log(`Array √ó Array done in ${(t1 - t0).toFixed(2)} ms`);
      }

      function testTypedArray() {
        const A = new Float32Array(size * size);
        const B = new Float32Array(size * size);
        const C = new Float32Array(size * size);
        for (let i = 0; i < size * size; i++) {
          A[i] = Math.random();
          B[i] = Math.random();
        }
        log("Starting Float32Array √ó Float32Array multiplication...");
        const t0 = performance.now();
        multiplyTypedArray(A, B, C, size);
        const t1 = performance.now();
        log(`Float32Array √ó Float32Array done in ${(t1 - t0).toFixed(2)} ms`);
      }
    </script>
  </body>
</html>
